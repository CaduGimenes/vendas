<!-- =============================================== -->
<style>
    .spacing {

        float: right;

    }
</style>
<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            Confirmar <b>Pedido</b>
        </h1>
        <ol class="breadcrumb">
            <li><a href="/"><i class="fa fa-bookmark"></i> Home</a></li>
            <li><a href="#"> Pedidos</a></li>
            <li><a href="#"> Confirmar pedido</a></li>
        </ol>
    </section>

    <!-- Main content -->
    <section class="content">
        <!-- Default box -->
        <div class="box">
            <div class="box-body">
                <div class="row">
                    <div class="col-md-12">
                        <div class="col-md-6 col-md-offset-3">
                            <div class="callout callout-success">
                                <h4 class="text-center">Pedido</h4>
                                Entrega<b class="spacing">R${function="formatPrice($user.vl_frete)"}</b>
                                <br>
                                <hr style="border-top:dotted;">
                                {loop="$orders"}
                                {$value.tamanho}<b class="spacing">R${function="formatPrice($value.valor)"}</b>
                                {/loop}
                                <br>
                                <hr style="border-top:solid;">
                                <b class="spacing">Total: R${function="formatPrice($total)"}</b>
                                <br>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-12">
                        <form action="/order/confirm" method="post">
                            <div class="col-md-12">
                                <form action="" method="post" class="total">
                                    <label for="paymentMethod"> Método de Pagamento:</label>
                                    <select onchange="onChange();" class="form-control" id="paymentMethod"
                                        name="paymentMethod" required oninput="this.setCustomValidity('')">
                                        <option value="" disabled selected>Selecione o método de pagamento</option>
                                        <option value="Dinheiro">Dinheiro</option>
                                        <option value="Crédito">Crédito</option>
                                        <option value="Débito">Débito</option>
                                    </select>
                                    <label for="clientValue"> Valor pago:</label>
                                    <input class="form-control" type="text" name="clientValue" id="clientValue"
                                        required>
                                </form>
                                <br>
                                <h2 id="troco">Troco:</h2>
                                <input type="hidden" name="changeValue" value="" id="changeValue">
                                <h1 id="change">R$</h1>
                                <button type="submit" class="btn btn-success btn-lg center-block">Finalizar</button>
                            </div>
                        </form>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
    </section>
    <!-- /.content -->
</div>
<!-- /.content-wrapper -->
<script src="/node_modules/jquery/dist/jquery.min.js"></script>
<!-- jQuery input mask -->
<script src="/node_modules/jquery-mask-plugin/dist/jquery.mask.min.js"></script>

<script src="/dist/js/paymentMethod.js"></script>

<script>
    $(document).ready(function () {

        let $j = jQuery.noConflict();
        $j("#troco").hide();
        $j("#change").hide();

        $('#clientValue').mask("#.###,00", {
            reverse: true
        })

        $('#clientValue').focus()

        $('#clientValue').keyup(function () {

            let dados = $('#clientValue').val();

            $('#change').empty()

            $.ajax({
                type: 'POST',
                url: '../dist/functions/getChange.php',
                async: true,
                data: {
                    clientValue: dados.replace('.', '').replace(',', '.')
                },
                success: function (response) {

                    if (response.replace("R$", "") > 0) {
                        $('input[name=changeValue]').val(response)
                        $('#change').append(response)
                    } else {
                        $('input[name=changeValue]').val("R$0.00");
                        $('#change').append("R$0.00")
                    }
                }
            });

        })

    })

    function onChange() {
        let $j = jQuery.noConflict();
        if ($('#paymentMethod').val() == "Dinheiro") {
            $j("#troco").show();
            $j("#change").show();
        } else {
            $j("#troco").hide();
            $j("#change").hide();
        }
    }


</script>